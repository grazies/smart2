<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Smart by grazies</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Smart</h1>
      <h2 class="project-tagline"></h2>
      <a href="https://github.com/grazies/smart2" class="btn">View on GitHub</a>
      <a href="https://github.com/grazies/smart2/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/grazies/smart2/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <ol>
<li>
<p>Overview</p>

<p>Smart2 is a package manager that based on smart. Smart2 support all the 
funtions of smart. In addition, smart2 has some new features.</p>

<hr>

<h2>
<a id="new-features" class="anchor" href="#new-features" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>New Features</h2>

<ul>
<li>A new interface named "tgui" can show you a gui on your character terminal.</li>
<li>Supports customizing your target rootfs on host development machine.</li>
</ul>

<p>Note
  More informations about smart, please reference to doc/ or <a href="http://labix.org/smart/howto">http://labix.org/smart/howto</a>.</p>
</li>
<li>
<p>How to get smart2</p>

<p>Smart2 now is managed on Github. You can get smart2 from there.
<a href="https://github.com/ubinux/smart2.git">https://github.com/ubinux/smart2.git</a></p>
</li>
<li>
<p>Installation</p>

<p>3.1 Dependencies</p>

<p>1) The dependencies are same as smart
     Smart2 is based on smart, so please make sure the prerequisites for smart have been installed.
     Please refrence to <a href="http://labix.org/smart/howto">http://labix.org/smart/howto</a> to obtain details.</p>

<p>2) Dependencies for smart2 new features.
     - python-newt:  the snack module depended by "tgui" graphic interface.</p>

<p>Note
    In some cases (e.g. Cross-Platform), maybe you can not use the above command
    which belongs to host directly. You should build a special one for your target-platform,
    and make sure it's available in your toolchain for Cross-Platform.</p>

<pre><code>E.g, for Yocto user, you should install the toolchain firstly
</code></pre>

<p>3.2 Installation</p>

<p>Cd into smart2 directory and execute the following commands as root:</p>

<hr>

<p># python setup.py build
   # python setup.py install</p>

<hr>

<p>Or you can use the supplied Makefile:</p>

<hr>

<p># make
   # make install</p>

<hr>

<p>Note
    After install you have to change the interpreter from "#!/usr/bin/python" to 
    "#!/usr/bin/env python" in your smart2 command.
    -----------------------------------------------------------------
     $ whereis smart
       smart: /opt/bin/smart
     $ cat /opt/bin/smart
       #!/usr/bin/env python
       ......
    -----------------------------------------------------------------</p>

<p>3.3 Global Setting</p>

<p>1) In Cross-Platform case, make sure the required commands can be invoked preferentially.
     For example, you can do it by the following command for Yocto-User
     -----------------------------------------------------------------------
      # source TOOLCHAIN/environment-setup-i586-poky-linux
     -----------------------------------------------------------------------</p>

<p>2) Make sure the following environment variable point to correct path.
     -----------------------------------------------------------------------
      # export RPM_USRLIBRPM=/usr/lib/rpm
      # export RPM_ETCRPM=/etc/rpm
      # export RPM_LOCALEDIR=/usr/share/locale
     -----------------------------------------------------------------------</p>

<pre><code>Note
  In Cross-Platform case, maybe you should customize these variable.
  E.g. for Yocto user, you should set them as following.
  -------------------------------------------------------------------
   # export RPM_USRLIBRPM=${OECORE_NATIVE_SYSROOT}/usr/lib/rpm
   # export RPM_ETCRPM=${SDKTARGETSYSROOT}/etc/rpm
   # export RPM_LOCALEDIR=${OECORE_NATIVE_SYSROOT}/usr/share/locale
  -------------------------------------------------------------------
</code></pre>
</li>
<li>
<p>How to manage packages</p>

<p>4.1 Prepare</p>

<p>You should construct the environment before doing install/remove/search operations. </p>

<p>Smart2 provides a script named enviroment-smart.sh to do it automaticly.
  It can help you to complete the following jobs:
    - Build pseudo environment.
    - Configure DB settings for packages sources (e.g. rpm, deb).
    - Configure smart2 settings for packages sources (e.g. rpm, deb).
    - Add channels for each packages source.</p>

<p>You can configure your smart2 environment as the following: </p>

<hr>

<p>$ . enviroment-smart.sh ROOTFS_DIR PACKAGES_DIR</p>

<hr>

<p>There must be two parameters for enviroment-smart.sh:</p>

<p>1) ROOTFS_DIR: The rootfs directory where you want to install packages.</p>

<pre><code> Note
   * ROOTFS_DIR must be absolute path.
   * If it doesn't exist, it will be created.
</code></pre>

<p>2) PACKAGES_DIR: The packages sources directory. There can be multiple packages sources
                   in this directory.</p>

<pre><code> Note
   Smart2 manage packages by repodata, make sure there is repodata in every sources
   directory under PACKAGES_DIR.
</code></pre>

<p>For example:
    If you build x86 by Yocto, there will be three packages sources for x86.
    And there is a repodata in each packages sources:
    -------------------------------------------------------------------
     # tree /home/test/x86_rpm/ | grep -v ".rpm"
       /home/test/x86_rpm/
       |-- all
       |   |-- repodata
       |   |   |-- filelists.xml.gz
       |   |   |-- other.xml.gz
       |   |   |-- primary.xml.gz
       |   |   |-- repomd.xml
       |-- i586
       |   |-- repodata
       |   |   |-- filelists.xml.gz
       |   |   |-- other.xml.gz
       |   |   |-- primary.xml.gz
       |   |   |-- repomd.xml
       |-- qemux86
       |   |-- repodata
       |   |   |-- filelists.xml.gz
       |   |   |-- other.xml.gz
       |   |   |-- primary.xml.gz
       |   |   |-- repomd.xml
    -------------------------------------------------------------------</p>

<pre><code>You can configure your smart2 environment for x86 by the following:
-------------------------------------------------------------------
 $ . enviroment-smart.sh /home/test/x86_rootfs /home/test/x86_rpm
-------------------------------------------------------------------
</code></pre>

<p>4.2 Create rootfs for Target-Platform</p>

<p>Smart2 supports a new interface named "tgui" which can 
  help you to customize your rootfs under character terminal in your development machine.</p>

<p>You will enter the tgui insterface with the option "--interface=tgui".
  For example:</p>

<hr>

<p>$ smart --rootfs-dir=$ROOTFS_DIR  --interface=tgui</p>

<hr>

<p>Note
    --rootfs-dir: rootfs directory that specified by enviroment-smart.sh.</p>

<p>After execute the above command, you can enter the interface of tgui:</p>

<p>1) Select install type
     Smart2 supports three kinds of install type:
     - install all
       By default, all pacakges will be selected.
     - Busybox base
       By default, only busybox packages will be selected.
     - customize
       By default, no packages will be selected.</p>

<p>2) Smart2 can help you filter GPLv3.
     If you select "install all" or "customize" in above, smart2 will ask you whether 
     you want to install packages which license is GPLv3.
     - No  : GPLv3 packages will not be selected and not display in the next step.
     - Yes : GPLv3 packages can be selected as same as the other packages.</p>

<p>3) customize packages</p>

<pre><code>------------------------------------- Select package -------------------------------------
|                                                                                        |
| [I] zip                                                                                |
| [*] zabbix                                                                             |
| [I] xz                                                                                 |
| [*] xwud                                                                               |
| [*] xwininfo                                                                           |
| [*] xwd                                                                                |
| [*] xvinfo                                                                             |
| [*] xterm                                                                              |
| [*] xstdcmap                                                                           |
| [*] xsetroot                                                                           |
| [*] xsetmode                                                                           |
| [*] xset                                                                               |
| [*] xserver-xorg-xwayland                                                              |
| [*] xserver-xorg-xvfb                                                                  |
| [I] xserver-xorg-utils                                                                 |
| [I] xserver-xorg-module-libwfb                                                         |
| [I] xserver-xorg-module-libint10                                                       |
| [*] xserver-xorg-module-exa                                                            |
| [*] xserver-xorg-extension-glx                                                         |
| [*] xserver-xorg                                                                       |
| [I] xserver-xf86-config                                                                |
| [*] xrestop                                                                            |
| [*] xrefresh                                                                           |
| -------------------------------------------------------------------------------------- |
| All Package [2609]    Installed Packages [1264] Selected Packages [2609]               |
| -------------------------------------------------------------------------------------- |
| SPACE/ENTER:select/unselect  R:seaRch N:Next  B:Back  I:Info  X:eXit                   |
------------------------------------------------------------------------------------------

Note
  -  [] Means the package has not been selected and installed. If you want to install it, you can 
        select it by pressing enter.
  - [*] Means the package has been selcted and will be installed. If you don't want to install it,
        you can cancel by pressing enter.
  - [I] Means the package has been installed in your rootfs. You can't select/unselect it in tgui.
        If you want to uninstall it.Please use the following command after exiting tgui.
        $ smart --rootfs-dir=/home/test/x86-rootfs remove pkgname

  - Next: If you press "N" or "n" in the interface, it will go to the next step.
</code></pre>

<p>4) customize packages type
     You can select the package type that you want to install into rootfs.</p>

<pre><code>---------------------------- customize special type packages ----------------------------  
|                                                                                        |
| locale [ ]                                                                             |
| dev [ ]                                                                                |
| doc [ ]                                                                                |
| dbg [ ]                                                                                |
| staticdev [ ]                                                                          |
| ptest [ ]                                                                              |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
|                                                                                        |
| -------------------------------------------------------------------------------------- |
| SPACE/ENTER:select/unselect  N:Next  B:Back  I:Info  X:eXit                            |
------------------------------------------------------------------------------------------

Note
  You can get details about the package type by pressing "I" or "i".
</code></pre>

<p>5) Confirm selection</p>

<pre><code> After you confirming your customization, the installation will begin.
</code></pre>

<p>6) Confirm installation</p>

<pre><code> To make sure the files in rootfs have correct uid and gid, notice that:
  * When rootfs is finished, please compress it into a tarball in the
    current terminal to keep the pseudo environment.
  * When unpack rootfs, please use sudo command with "--numeric-owner" option.

    For example:
    -------------------------------------------------------------------
     $ . enviroment-smart.sh /home/test/x86_rootfs /home/test/x86_rpm
     $ smart --rootfs-dir=/home/test/x86_rootfs  --interface=tgui
     $ cd /home/test/
     $ tar cvf - x86-rootfs | (cd $DEST_DIR ;sudo tar xvf - --numeric-owner)
    -------------------------------------------------------------------
</code></pre>

<p>4.3 Smart2 Commands</p>

<p>Besides "tgui", you also can manage packages by command line with the option 
  "--rootfs-dir".
  For example:</p>

<hr>

<p>$ smart --rootfs-dir=/home/test/x86-rootfs install pkgname
   $ smart --rootfs-dir=/home/test/x86-rootfs remove pkgname
   $ smart --rootfs-dir=/home/test/x86-rootfs query '<em>kgnam</em>'</p>

<hr>

<p>More commands please reference to doc/ or <a href="http://labix.org/smart/howto">http://labix.org/smart/howto</a>.</p>
</li>
</ol>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/grazies/smart2">Smart</a> is maintained by <a href="https://github.com/grazies">grazies</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
